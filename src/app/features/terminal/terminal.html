<div
  class="flex flex-col h-full w-full bg-gnome-bg text-gnome-text font-mono text-sm p-4 overflow-hidden transition-colors duration-300"
  (click)="focusInput()"
>
  <div class="flex-1 overflow-y-auto custom-scrollbar flex flex-col gap-1" #scrollContainer>
    <div class="text-gnome-blue font-bold mb-2">
      {{ lang.t().terminal.welcome }}
    </div>
    <div class="text-gnome-text-secondary mb-4 italic opacity-60">
      {{ lang.t().terminal.helpMsg }}
    </div>

    @for (line of history(); track $index) {
    <div class="terminal-line mb-3">
      <div class="flex gap-2">
        <span class="text-green-500 font-bold">user@caios:{{ line.path }}$</span>
        <span class="text-gnome-text">{{ line.command }}</span>
      </div>

      @if (line.output) {
      <div class="whitespace-pre-wrap pl-4 mt-1 border-l border-gnome-border/30">
        @for (item of line.output.split('\n'); track $index) { @if (item.startsWith('[NEO]')) {
        <div class="flex">
          <span class="text-gnome-blue font-bold">
            {{ item.substring(5).split('|')[0] }}
          </span>
          <span class="text-gnome-text ml-3">
            {{ item.split('|')[1] }}
          </span>
        </div>
        } @else if (item.startsWith('[DIR]')) {
        <div class="text-gnome-blue font-bold inline-block mr-4">
          ğŸ“ {{ item.replace('[DIR]', '') }}
        </div>
        } @else if (item.startsWith('[FILE]')) {
        <div class="text-gnome-text inline-block mr-4">ğŸ“„ {{ item.replace('[FILE]', '') }}</div>
        } @else {
        <div class="text-gnome-text-secondary/80">
          {{ item }}
        </div>
        } }
      </div>
      }
    </div>
    }
  </div>

  <div class="flex gap-2 items-center mt-2 shrink-0 border-t border-gnome-border pt-2">
    <span class="text-green-500 font-bold shrink-0">{{ prompt() }}</span>
    <input
      #termInput
      type="text"
      class="flex-1 bg-transparent border-none outline-none text-gnome-text caret-gnome-blue font-mono"
      [placeholder]="lang.t().terminal.placeholder"
      (keydown.enter)="handleCommand($event)"
      (keydown)="handleKeydown($event)"
      spellcheck="false"
      autocomplete="off"
    />
  </div>
</div>
